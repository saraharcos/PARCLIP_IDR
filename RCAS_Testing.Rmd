---
title: "IDR Testing"
author: "Sarah Arcos"
date: "1/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(RCAS)

```

# Read in data
```{r}
r2_bw3 <- readRDS("~/files/PARCLIP_IDR/data/df2_rep2.rda")
r3_bw3 <- readRDS("~/files/PARCLIP_IDR/data/df2_rep3.rda")

r_fracs <- readRDS("~/files/PARCLIP_IDR/data/r2_r3_overlaps.rda")

idr_mc <- readRDS("~/files/PARCLIP_IDR/data/idr_summ_T2Cfraction_MC1000")

m6A_r1 <- readRDS("~/files/PARCLIP_IDR/data/m6A_rep1.rda")
m6A_r2 <- readRDS("~/files/PARCLIP_IDR/data/m6A_rep2.rda")
m6A_r1_q0.2 <- readRDS("~/files/PARCLIP_IDR/data/m6A_rep1_q0.2.rda")
m6A_r2_q0.2 <- readRDS("~/files/PARCLIP_IDR/data/m6A_rep2_q0.2.rda")

m6A_overlaps <- readRDS("~/files/PARCLIP_IDR/data/m6A_overlaps.rda")

idr_m6A <- readRDS("~/files/PARCLIP_IDR/data/idr_summ_m6A_MC1000")


df2_m6A <- readRDS("~/files/PARCLIP_IDR/data/df2_m6A.rda")
```

#save each of m6A/non-m6A as bed file
```{r}
df2_m6A %>%
  filter(m6A == "m6A") %>%
  dplyr::select(Chromosome, Start, End, r3_name, T2Cfraction) %>%
  write_tsv("df2_m6A.bed", col_names = FALSE)

runReport(queryFilePath = 'df2_m6A.bed',
            gffFilePath = '~/files/PARpipe/files/gencode.v19.chr_patch_hapl_scaff.annotation.gtf',
            msigdbAnalysis = FALSE)
```



```{r}
sessionInfo()
```













